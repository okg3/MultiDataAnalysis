<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Olivia Gardner" />

<meta name="date" content="2020-03-11" />

<title>MultiDataAnalysisTutorial</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">MultiDataAnalysisTutorial</h1>
<h4 class="author">Olivia Gardner</h4>
<h4 class="date">2020-03-11</h4>



<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MultiDataAnalysis)
<span class="co">#&gt; Loading required package: data.table</span></code></pre></div>
<p>This package facilitates combining data from multiple files, experiments, or datasets into one analysis. In particular, this package has two main functionalities: 1. Merging files that are split by sample into one data set by experiment/measurement type, and 2. Applying a regression model to all rows of one or more matrices using data from multiple data sets. In this tutorial, we will explore different applications and parameters for these functions.</p>
<div id="merging-data-from-multiple-files-into-one-data-set" class="section level1">
<h1>Merging Data from Multiple Files into One Data Set</h1>
<p>The MergeIndividualFiles function reads in files containing data from individual samples and merges individual data into one dataset by variable or measurement.</p>
<p>For this example, we will use data that has been installed with the MultiDataAnalysis package in the extdata/ folder. You can also download these files directly from github: <a href="https://github.com/okg3/MultiDataAnalysis/tree/master/inst/extdata" class="uri">https://github.com/okg3/MultiDataAnalysis/tree/master/inst/extdata</a></p>
<p>We will be looking at sample data from an RNA editing experiment using 8 samples.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># set dirPath to extdata directory in package path </span>
dirPath &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">path.package</span>(<span class="st">&quot;MultiDataAnalysis&quot;</span>), <span class="st">&quot;/extdata/&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dirPath
<span class="co">#&gt; [1] &quot;C:/Users/ogard/Documents/R/win-library/3.5/MultiDataAnalysis/extdata/&quot;</span>
<span class="co"># Data is split into separate files by sample</span>
<span class="kw">list.files</span>(dirPath, <span class="dt">pattern =</span> <span class="st">&quot;.txt.gz&quot;</span>)
<span class="co">#&gt; [1] &quot;sample1.txt.gz&quot; &quot;sample2.txt.gz&quot; &quot;sample3.txt.gz&quot; &quot;sample4.txt.gz&quot;</span>
<span class="co">#&gt; [5] &quot;sample5.txt.gz&quot; &quot;sample6.txt.gz&quot; &quot;sample7.txt.gz&quot; &quot;sample8.txt.gz&quot;</span></code></pre></div>
<p>Let’s load one file to look at values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">file1 &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="kw">paste0</span>(dirPath, <span class="st">&quot;sample1.txt.gz&quot;</span>))
<span class="kw">head</span>(file1)
<span class="co">#&gt;    Region  Position Reference Strand RepMask_feat RepMask_gid</span>
<span class="co">#&gt; 1:  chr10 100233036         T      1         SINE       AluJo</span>
<span class="co">#&gt; 2:  chr10 100233053         T      1         SINE       AluJo</span>
<span class="co">#&gt; 3:  chr10 101789717         T      1         SINE       AluJb</span>
<span class="co">#&gt; 4:  chr10 101789723         T      1         SINE       AluJb</span>
<span class="co">#&gt; 5:  chr10 101789782         T      1         SINE       AluJb</span>
<span class="co">#&gt; 6:  chr10 101789903         T      1         SINE       AluJb</span>
<span class="co">#&gt;             RefSeq_feat RefSeq_gid RADAR_feat RADAR_gid DARNED_feat DARNED_gid</span>
<span class="co">#&gt; 1: 3UTR,exon,transcript    CWF19L1       3UTR   CWF19L1           .    CWF19L1</span>
<span class="co">#&gt; 2: 3UTR,exon,transcript    CWF19L1       3UTR   CWF19L1           .    CWF19L1</span>
<span class="co">#&gt; 3:           transcript        OGA   intronic     MGEA5           .      MGEA5</span>
<span class="co">#&gt; 4:           transcript        OGA   intronic     MGEA5           .      MGEA5</span>
<span class="co">#&gt; 5:           transcript        OGA   intronic     MGEA5           .      MGEA5</span>
<span class="co">#&gt; 6:           transcript        OGA   intronic     MGEA5           .      MGEA5</span>
<span class="co">#&gt;    REDIportal_feat REDIportal_gid AllSubs Coverage-q25 MeanQ BaseCount[A,C,G,T]</span>
<span class="co">#&gt; 1:  ncRNA_intronic  RP11-316M21.6      TC           27 38.26      [0, 8, 0, 19]</span>
<span class="co">#&gt; 2:  ncRNA_intronic  RP11-316M21.6      TC           27 36.89      [0, 6, 0, 21]</span>
<span class="co">#&gt; 3:        intronic          MGEA5      TC           71 38.69     [0, 14, 0, 57]</span>
<span class="co">#&gt; 4:        intronic          MGEA5      TC           66 37.62     [0, 34, 0, 32]</span>
<span class="co">#&gt; 5:        intronic          MGEA5      TC           46 38.24     [1, 17, 0, 28]</span>
<span class="co">#&gt; 6:        intronic          MGEA5      TC           72 37.85     [0, 16, 0, 56]</span>
<span class="co">#&gt;    Frequency       Pvalue</span>
<span class="co">#&gt; 1:      0.30 1.215299e-02</span>
<span class="co">#&gt; 2:      0.22 5.014270e-02</span>
<span class="co">#&gt; 3:      0.20 2.631754e-04</span>
<span class="co">#&gt; 4:      0.52 4.167670e-12</span>
<span class="co">#&gt; 5:      0.38 1.355112e-05</span>
<span class="co">#&gt; 6:      0.22 5.983720e-05</span></code></pre></div>
<p>In this data, the unique editing events are identified by the columns Region, Position, Reference, and Strand.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">idCols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Region&quot;</span>, <span class="st">&quot;Position&quot;</span>, <span class="st">&quot;Reference&quot;</span>, <span class="st">&quot;Strand&quot;</span>)</code></pre></div>
<p>The columns AllSubs, Coverage-q25, MeanQ, BaseCount[A,C,G,T], Frequency, and Pvalue all represent individual meansurements that are specific to this sample. In order to compare measurements across samples, we will want to combine all of the Frequency columns from different samples into one matrix, all Coverage columns into another matrix, etc.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">IndVars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AllSubs&quot;</span>, <span class="st">&quot;Coverage-q25&quot;</span>, <span class="st">&quot;MeanQ&quot;</span>, <span class="st">&quot;BaseCount[A,C,G,T]&quot;</span>, 
             <span class="st">&quot;Frequency&quot;</span>, <span class="st">&quot;Pvalue&quot;</span>)</code></pre></div>
<p>The remaining columns are annotations of the unique editing events which we will want to keep in a separate annotation data.frame.</p>
<p>To combine these datasets, we will use the MergeIndividualFiles function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out &lt;-<span class="st"> </span><span class="kw">MergeIndividualFiles</span>(
  <span class="dt">fileDirectory =</span> dirPath,
  <span class="dt">filePattern =</span> <span class="st">&quot;.txt.gz&quot;</span>, 
  <span class="dt">indVars =</span> IndVars,
  <span class="dt">IDcol =</span> idCols
)
<span class="kw">names</span>(out)
<span class="co">#&gt; [1] &quot;Annotation&quot;         &quot;AllSubs&quot;            &quot;Coverage-q25&quot;      </span>
<span class="co">#&gt; [4] &quot;MeanQ&quot;              &quot;BaseCount[A,C,G,T]&quot; &quot;Frequency&quot;         </span>
<span class="co">#&gt; [7] &quot;Pvalue&quot;</span></code></pre></div>
<p>Our merged dataset is a list containing one Annotation data.frame and 6 matrices with individual sample values for the 6 variables defined in indVars.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(out<span class="op">$</span>Annotation)
<span class="co">#&gt;                     id Region  Position Reference Strand RepMask_feat</span>
<span class="co">#&gt; 1: chr10_100233036_T_1  chr10 100233036         T      1         SINE</span>
<span class="co">#&gt; 2: chr10_100233053_T_1  chr10 100233053         T      1         SINE</span>
<span class="co">#&gt; 3: chr10_101789717_T_1  chr10 101789717         T      1         SINE</span>
<span class="co">#&gt; 4: chr10_101789723_T_1  chr10 101789723         T      1         SINE</span>
<span class="co">#&gt; 5: chr10_101789782_T_1  chr10 101789782         T      1         SINE</span>
<span class="co">#&gt; 6: chr10_101789903_T_1  chr10 101789903         T      1         SINE</span>
<span class="co">#&gt;    RepMask_gid          RefSeq_feat RefSeq_gid RADAR_feat RADAR_gid DARNED_feat</span>
<span class="co">#&gt; 1:       AluJo 3UTR,exon,transcript    CWF19L1       3UTR   CWF19L1           .</span>
<span class="co">#&gt; 2:       AluJo 3UTR,exon,transcript    CWF19L1       3UTR   CWF19L1           .</span>
<span class="co">#&gt; 3:       AluJb           transcript        OGA   intronic     MGEA5           .</span>
<span class="co">#&gt; 4:       AluJb           transcript        OGA   intronic     MGEA5           .</span>
<span class="co">#&gt; 5:       AluJb           transcript        OGA   intronic     MGEA5           .</span>
<span class="co">#&gt; 6:       AluJb           transcript        OGA   intronic     MGEA5           .</span>
<span class="co">#&gt;    DARNED_gid REDIportal_feat REDIportal_gid</span>
<span class="co">#&gt; 1:    CWF19L1  ncRNA_intronic  RP11-316M21.6</span>
<span class="co">#&gt; 2:    CWF19L1  ncRNA_intronic  RP11-316M21.6</span>
<span class="co">#&gt; 3:      MGEA5        intronic          MGEA5</span>
<span class="co">#&gt; 4:      MGEA5        intronic          MGEA5</span>
<span class="co">#&gt; 5:      MGEA5        intronic          MGEA5</span>
<span class="co">#&gt; 6:      MGEA5        intronic          MGEA5</span>

<span class="kw">head</span>(out<span class="op">$</span>Frequency)
<span class="co">#&gt;                     sample1 sample2 sample3 sample4 sample5 sample6 sample7</span>
<span class="co">#&gt; chr10_100233036_T_1    0.30    0.33    0.26    0.30    0.22    0.25    0.23</span>
<span class="co">#&gt; chr10_100233053_T_1    0.22    0.47    0.25    0.50    0.30    0.52    0.38</span>
<span class="co">#&gt; chr10_101789717_T_1    0.20    0.19    0.21    0.29    0.35    0.26    0.30</span>
<span class="co">#&gt; chr10_101789723_T_1    0.52    0.54    0.48    0.53    0.66    0.71    0.56</span>
<span class="co">#&gt; chr10_101789782_T_1    0.38    0.43    0.41    0.33    0.49    0.62    0.40</span>
<span class="co">#&gt; chr10_101789903_T_1    0.22    0.29    0.38    0.30    0.41    0.28    0.28</span>
<span class="co">#&gt;                     sample8</span>
<span class="co">#&gt; chr10_100233036_T_1    0.29</span>
<span class="co">#&gt; chr10_100233053_T_1    0.32</span>
<span class="co">#&gt; chr10_101789717_T_1    0.20</span>
<span class="co">#&gt; chr10_101789723_T_1    0.57</span>
<span class="co">#&gt; chr10_101789782_T_1    0.55</span>
<span class="co">#&gt; chr10_101789903_T_1    0.34</span></code></pre></div>
<p>Each matrix has 8 columns names after the file names, after removing the pattern defined in filePattern. Matrix rownames match the id column in the Annotation data.frame.</p>
</div>
<div id="regression-model-with-multiple-data-sets" class="section level1">
<h1>Regression Model with Multiple Data Sets</h1>
<p>The ModelMultiData function applies a regression model across all rows of one or more matrices with inputs from multiple data sets and returns the summary regression coefficients.</p>
<div id="working-with-multiple-data-sets" class="section level2">
<h2>Working with Multiple Data Sets</h2>
<p>This function accepts four main inputs:</p>
<ul>
<li>x: A matrix or list of matrices whose rows contain iterative values for models</li>
<li>y: A matrix whose rows contain values to be used on left-hand side of model (for example, in a QTL analysis)</li>
<li>groups: A data.frame with additional information regarding the samples in column names of x and y, such as disease affection status, sequencing batch, height, weight, etc.</li>
<li>comparisons (Optional): A matrix that specifies which combinations of rows in x and y should be tested together. See <strong>Defining Comparisons</strong> section below for more details.</li>
</ul>
<p>To use this function, x must be supplied, and at least one of y or groups must also be defined.</p>
<div id="one-x-matrix-vs-groups" class="section level3">
<h3>One x matrix vs groups</h3>
<p>Here, we loop through all rows of a single x matrix and test for association with a groups object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(xExample1)
<span class="co">#&gt;                 sample1    sample2    sample3     sample4    sample5</span>
<span class="co">#&gt; observation1  1.6074939 -0.7161041 -0.9631803  1.94942666 -0.0944665</span>
<span class="co">#&gt; observation2 -0.5239034 -0.5591129 -0.5264781  1.58489513 -0.5046199</span>
<span class="co">#&gt; observation3  0.2335376 -0.8596494 -1.0784309 -0.08594354 -1.8842273</span>
<span class="co">#&gt; observation4  0.7194662 -1.4667298 -1.7323573  1.19673071  0.1179928</span>
<span class="co">#&gt; observation5  1.3214352 -1.0851098 -0.1664036  0.81151703 -1.3585044</span>
<span class="co">#&gt; observation6 -0.9105424  0.7780117  0.6915056 -1.01995830 -1.3509444</span>
<span class="co">#&gt;                  sample6    sample7     sample8    sample9   sample10</span>
<span class="co">#&gt; observation1  1.02199695  0.6012214  0.18427671  0.3679187  0.1885970</span>
<span class="co">#&gt; observation2  0.26550224 -2.0729963  0.51724825  0.8129594 -0.3868082</span>
<span class="co">#&gt; observation3 -0.02768048  0.2815849 -0.02625661  0.5975058 -1.2357269</span>
<span class="co">#&gt; observation4 -0.09064402  0.1662458 -0.82435489  2.1205018  0.2206702</span>
<span class="co">#&gt; observation5 -0.29238911 -0.8881475 -0.07659848 -0.5428606 -1.1322455</span>
<span class="co">#&gt; observation6  1.44218046  0.6263428 -0.03460362 -0.5967028  1.4989313</span>
<span class="co">#&gt;                sample11   sample12   sample13    sample14   sample15</span>
<span class="co">#&gt; observation1  1.6147609  0.2416964  0.3136588  0.39691793  0.2098646</span>
<span class="co">#&gt; observation2  0.2845455 -0.3906833 -0.2194579  0.80457488 -0.6530981</span>
<span class="co">#&gt; observation3 -0.6615305  0.2402145  1.1398168 -0.05138417  2.9216279</span>
<span class="co">#&gt; observation4  2.1312026  0.4772372 -0.7612767 -1.07064394 -0.3487523</span>
<span class="co">#&gt; observation5 -1.4711422 -0.3565565 -1.5036411  0.44426872 -2.2462408</span>
<span class="co">#&gt; observation6  0.6957211  0.5905341  0.7947177 -0.29014698 -1.6509872</span>
<span class="co">#&gt;                 sample16  sample17   sample18   sample19   sample20</span>
<span class="co">#&gt; observation1 -0.07031937 -1.148118  1.2778739 -1.2352460  1.6465908</span>
<span class="co">#&gt; observation2  0.61116049 -1.757492  0.6381955 -0.5258459 -0.2311207</span>
<span class="co">#&gt; observation3  0.54550948  1.319463  0.8757585 -0.1791966  0.1553590</span>
<span class="co">#&gt; observation4  1.20900522 -0.105902 -0.3326209 -0.6528516 -0.2311279</span>
<span class="co">#&gt; observation5 -0.79518426  1.515252 -1.5947369 -0.3989462 -0.4038657</span>
<span class="co">#&gt; observation6 -0.80945454 -1.201972  0.3532008  0.4091456  1.9842266</span>
<span class="kw">dim</span>(xExample1)
<span class="co">#&gt; [1] 100  20</span>
groupsExample1
<span class="co">#&gt;       sample  measure     group batch</span>
<span class="co">#&gt;  1:  sample1 21.52951   Treated     3</span>
<span class="co">#&gt;  2:  sample2 20.33867   Treated     2</span>
<span class="co">#&gt;  3:  sample3 20.37980   Treated     1</span>
<span class="co">#&gt;  4:  sample4 21.57565   Treated     4</span>
<span class="co">#&gt;  5:  sample5 20.39286 Untreated     3</span>
<span class="co">#&gt;  6:  sample6 18.29787 Untreated     3</span>
<span class="co">#&gt;  7:  sample7 19.68716   Treated     1</span>
<span class="co">#&gt;  8:  sample8 20.26707 Untreated     1</span>
<span class="co">#&gt;  9:  sample9 20.83652 Untreated     4</span>
<span class="co">#&gt; 10: sample10 20.83301   Treated     4</span>
<span class="co">#&gt; 11: sample11 21.21224 Untreated     1</span>
<span class="co">#&gt; 12: sample12 20.78262   Treated     1</span>
<span class="co">#&gt; 13: sample13 20.68581 Untreated     2</span>
<span class="co">#&gt; 14: sample14 18.08249 Untreated     2</span>
<span class="co">#&gt; 15: sample15 19.88048 Untreated     4</span>
<span class="co">#&gt; 16: sample16 19.20022 Untreated     3</span>
<span class="co">#&gt; 17: sample17 20.32357 Untreated     2</span>
<span class="co">#&gt; 18: sample18 20.87956   Treated     1</span>
<span class="co">#&gt; 19: sample19 18.76966   Treated     1</span>
<span class="co">#&gt; 20: sample20 21.55513 Untreated     4</span></code></pre></div>
<p>Note that the first column of the groups object matches the column names in x. Each row of x represents a separate measurement or observation. We can loop through all observations in x and test against the second column of groups by running:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># One x dataset vs groups</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> xExample1, <span class="dt">groups =</span> groupsExample1)
<span class="co">#&gt; Warning in BuildFormula(x = x, y = y, groups = groups, by = by, xName = xName, : Warning: yName missing. Default value is second column of groups, post inclusion/exclusion criteria: measure</span>
<span class="co">#&gt; Warning in BuildFormula(x = x, y = y, groups = groups, by = by, xName = xName, : Warning: argument &quot;formula&quot; undefined. Using formula constructed from provided data: measure ~ group + batch + x1</span>
<span class="kw">head</span>(out)
<span class="co">#&gt;              x1 variable    Estimate Std. Error     t value     pValue</span>
<span class="co">#&gt; 1: observation1       x1  0.42741101  0.2445109  1.74802432 0.09961871</span>
<span class="co">#&gt; 2: observation2       x1  0.03653756  0.2869655  0.12732389 0.90027052</span>
<span class="co">#&gt; 3: observation3       x1 -0.01802801  0.2400874 -0.07508937 0.94107445</span>
<span class="co">#&gt; 4: observation4       x1  0.33987748  0.2267981  1.49859033 0.15344989</span>
<span class="co">#&gt; 5: observation5       x1 -0.01976259  0.2450910 -0.08063368 0.93673328</span>
<span class="co">#&gt; 6: observation6       x1  0.01248081  0.2398526  0.05203533 0.95914467</span>
<span class="co">#&gt;          fdr</span>
<span class="co">#&gt; 1: 0.8038727</span>
<span class="co">#&gt; 2: 0.9970974</span>
<span class="co">#&gt; 3: 0.9970974</span>
<span class="co">#&gt; 4: 0.8038727</span>
<span class="co">#&gt; 5: 0.9970974</span>
<span class="co">#&gt; 6: 0.9970974</span></code></pre></div>
<p>By default, if no formula is provided, ModelMultiData will build a formula using the provided data. If groups is defined and y is not, then the left-hand variable defaults to the second column of groups. To further modify the model formula, see the section <strong>Adjusting the Model</strong> below.</p>
</div>
<div id="one-x-matrix-vs-y-matrix" class="section level3">
<h3>One x matrix vs y matrix</h3>
<p>By contrast, we may wish to loop through all rows of an x matrix and test for associations with rows of a y matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(xExample1)
<span class="co">#&gt;                 sample1    sample2    sample3     sample4    sample5</span>
<span class="co">#&gt; observation1  1.6074939 -0.7161041 -0.9631803  1.94942666 -0.0944665</span>
<span class="co">#&gt; observation2 -0.5239034 -0.5591129 -0.5264781  1.58489513 -0.5046199</span>
<span class="co">#&gt; observation3  0.2335376 -0.8596494 -1.0784309 -0.08594354 -1.8842273</span>
<span class="co">#&gt; observation4  0.7194662 -1.4667298 -1.7323573  1.19673071  0.1179928</span>
<span class="co">#&gt; observation5  1.3214352 -1.0851098 -0.1664036  0.81151703 -1.3585044</span>
<span class="co">#&gt; observation6 -0.9105424  0.7780117  0.6915056 -1.01995830 -1.3509444</span>
<span class="co">#&gt;                  sample6    sample7     sample8    sample9   sample10</span>
<span class="co">#&gt; observation1  1.02199695  0.6012214  0.18427671  0.3679187  0.1885970</span>
<span class="co">#&gt; observation2  0.26550224 -2.0729963  0.51724825  0.8129594 -0.3868082</span>
<span class="co">#&gt; observation3 -0.02768048  0.2815849 -0.02625661  0.5975058 -1.2357269</span>
<span class="co">#&gt; observation4 -0.09064402  0.1662458 -0.82435489  2.1205018  0.2206702</span>
<span class="co">#&gt; observation5 -0.29238911 -0.8881475 -0.07659848 -0.5428606 -1.1322455</span>
<span class="co">#&gt; observation6  1.44218046  0.6263428 -0.03460362 -0.5967028  1.4989313</span>
<span class="co">#&gt;                sample11   sample12   sample13    sample14   sample15</span>
<span class="co">#&gt; observation1  1.6147609  0.2416964  0.3136588  0.39691793  0.2098646</span>
<span class="co">#&gt; observation2  0.2845455 -0.3906833 -0.2194579  0.80457488 -0.6530981</span>
<span class="co">#&gt; observation3 -0.6615305  0.2402145  1.1398168 -0.05138417  2.9216279</span>
<span class="co">#&gt; observation4  2.1312026  0.4772372 -0.7612767 -1.07064394 -0.3487523</span>
<span class="co">#&gt; observation5 -1.4711422 -0.3565565 -1.5036411  0.44426872 -2.2462408</span>
<span class="co">#&gt; observation6  0.6957211  0.5905341  0.7947177 -0.29014698 -1.6509872</span>
<span class="co">#&gt;                 sample16  sample17   sample18   sample19   sample20</span>
<span class="co">#&gt; observation1 -0.07031937 -1.148118  1.2778739 -1.2352460  1.6465908</span>
<span class="co">#&gt; observation2  0.61116049 -1.757492  0.6381955 -0.5258459 -0.2311207</span>
<span class="co">#&gt; observation3  0.54550948  1.319463  0.8757585 -0.1791966  0.1553590</span>
<span class="co">#&gt; observation4  1.20900522 -0.105902 -0.3326209 -0.6528516 -0.2311279</span>
<span class="co">#&gt; observation5 -0.79518426  1.515252 -1.5947369 -0.3989462 -0.4038657</span>
<span class="co">#&gt; observation6 -0.80945454 -1.201972  0.3532008  0.4091456  1.9842266</span>
<span class="kw">dim</span>(xExample1)
<span class="co">#&gt; [1] 100  20</span>
<span class="kw">head</span>(yExample1)
<span class="co">#&gt;                  sample1    sample2    sample3    sample4    sample5    sample6</span>
<span class="co">#&gt; observation1 -0.06939928 -0.7384105 -0.6730109 -0.4724098  1.1168548  0.3756368</span>
<span class="co">#&gt; observation2  1.26013848  0.4450383 -0.4515301 -0.4168176 -0.7974646  0.3697041</span>
<span class="co">#&gt; observation3 -3.18306622 -0.7396634 -0.2873841 -0.9395210  0.8618578  0.8211470</span>
<span class="co">#&gt; observation4  0.39795030 -0.7452504  0.1345227  0.3347204 -0.9306661 -1.3270468</span>
<span class="co">#&gt; observation5 -0.73323504  0.7601600  0.5043318  1.4649051 -0.7655591 -0.7313311</span>
<span class="co">#&gt; observation6 -1.09084518 -1.5237190 -0.2409990 -0.1467727  0.4105034  0.5653711</span>
<span class="co">#&gt;                 sample7    sample8    sample9   sample10   sample11   sample12</span>
<span class="co">#&gt; observation1 -1.4705927  0.8544683 -1.1273979 -0.2097531 -1.2152782  1.6568482</span>
<span class="co">#&gt; observation2  0.9650892  0.2246124  0.3408098 -1.7748545  1.2286632 -0.2336367</span>
<span class="co">#&gt; observation3  0.1300878  0.6055427  0.4321744 -0.3243136 -2.1350492  0.8165532</span>
<span class="co">#&gt; observation4  0.8131883 -1.2304825 -0.2800871 -0.4731875 -0.7140329 -0.7729567</span>
<span class="co">#&gt; observation5 -0.9740521 -1.2326422 -0.4380646 -0.9235119  0.6708332 -1.2017663</span>
<span class="co">#&gt; observation6  1.7677275 -0.8808946  2.0446408  0.4591090 -0.7049439  0.6539222</span>
<span class="co">#&gt;                 sample13   sample14    sample15   sample16   sample17</span>
<span class="co">#&gt; observation1  0.42681982  0.7759385  1.94029456 -1.3707760  0.7244123</span>
<span class="co">#&gt; observation2  0.60521191 -0.8479064 -0.85963657 -0.2349796  0.8623646</span>
<span class="co">#&gt; observation3 -1.19086098 -0.6572907  0.19188022 -0.5690210  0.8239664</span>
<span class="co">#&gt; observation4 -0.05699483  0.5502519 -0.02290214 -1.5568459 -1.6903181</span>
<span class="co">#&gt; observation5 -1.88013211 -0.3533861 -1.57411592 -1.2624137 -0.8392030</span>
<span class="co">#&gt; observation6  0.90731782 -2.0604679  1.09537786  0.9629660 -0.7233220</span>
<span class="co">#&gt;                sample18   sample19    sample20</span>
<span class="co">#&gt; observation1  0.2148523  0.6985863  0.40993753</span>
<span class="co">#&gt; observation2  2.9102921 -0.2869170 -0.09322197</span>
<span class="co">#&gt; observation3 -4.5361174 -1.3839620  0.73801653</span>
<span class="co">#&gt; observation4 -1.1192354 -0.5417413  1.42777283</span>
<span class="co">#&gt; observation5 -0.1979122  0.9225829  1.15072761</span>
<span class="co">#&gt; observation6 -0.7586881  0.7909019 -0.72119196</span>
<span class="kw">dim</span>(yExample1)
<span class="co">#&gt; [1] 100  20</span></code></pre></div>
<p>Note that x and y both share the same column names.</p>
<p>By default, if x and y have the same row names, the function assumes that rows that share the same name should be grouped together:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> xExample1, <span class="dt">y =</span> yExample1)
<span class="co">#&gt; Warning in BuildFormula(x = x, y = y, groups = groups, by = by, xName = xName, : Warning: argument &quot;formula&quot; undefined. Using formula constructed from provided data: y ~ x1</span>
<span class="kw">head</span>(out)
<span class="co">#&gt;               y           x1 variable    Estimate Std. Error    t value</span>
<span class="co">#&gt; 1: observation1 observation1       x1 -0.16614895  0.2438993 -0.6812195</span>
<span class="co">#&gt; 2: observation2 observation2       x1 -0.05193190  0.2750411 -0.1888151</span>
<span class="co">#&gt; 3: observation3 observation3       x1 -0.07357111  0.3266749 -0.2252120</span>
<span class="co">#&gt; 4: observation4 observation4       x1 -0.06836202  0.1859268 -0.3676824</span>
<span class="co">#&gt; 5: observation5 observation5       x1  0.20622617  0.2273269  0.9071789</span>
<span class="co">#&gt; 6: observation6 observation6       x1 -0.06429087  0.2490670 -0.2581268</span>
<span class="co">#&gt;       pValue       fdr</span>
<span class="co">#&gt; 1: 0.5044031 0.9921644</span>
<span class="co">#&gt; 2: 0.8523503 0.9921644</span>
<span class="co">#&gt; 3: 0.8243514 0.9921644</span>
<span class="co">#&gt; 4: 0.7173979 0.9921644</span>
<span class="co">#&gt; 5: 0.3762974 0.9921644</span>
<span class="co">#&gt; 6: 0.7992373 0.9921644</span></code></pre></div>
<p>If x and y have different row names, the function tests all possible combinations of x and y:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> xExample1, <span class="dt">y =</span> yExample2)
<span class="co">#&gt; Warning in BuildFormula(x = x, y = y, groups = groups, by = by, xName = xName, : Warning: argument &quot;formula&quot; undefined. Using formula constructed from provided data: y ~ x1</span>
<span class="kw">head</span>(out)
<span class="co">#&gt;           y           x1 variable    Estimate Std. Error    t value    pValue</span>
<span class="co">#&gt; 1: outcome1 observation1       x1 -0.15955605  0.2410233 -0.6619943 0.5163613</span>
<span class="co">#&gt; 2: outcome1 observation2       x1 -0.28256030  0.2571090 -1.0989903 0.2862549</span>
<span class="co">#&gt; 3: outcome1 observation3       x1 -0.19399951  0.2169126 -0.8943672 0.3829288</span>
<span class="co">#&gt; 4: outcome1 observation4       x1 -0.05984772  0.2180266 -0.2744973 0.7868281</span>
<span class="co">#&gt; 5: outcome1 observation5       x1 -0.09116108  0.2333592 -0.3906470 0.7006430</span>
<span class="co">#&gt; 6: outcome1 observation6       x1 -0.10081408  0.2213333 -0.4554853 0.6542068</span>
<span class="co">#&gt;          fdr</span>
<span class="co">#&gt; 1: 0.9649090</span>
<span class="co">#&gt; 2: 0.9195787</span>
<span class="co">#&gt; 3: 0.9388536</span>
<span class="co">#&gt; 4: 0.9828695</span>
<span class="co">#&gt; 5: 0.9764261</span>
<span class="co">#&gt; 6: 0.9759054</span></code></pre></div>
<p>To specify combinations, see <strong>Defining Comparisons</strong> below.</p>
</div>
<div id="list-of-x-matrices" class="section level3">
<h3>List of x matrices</h3>
<p>We can use multiple iterative data sets in the same model by providing a list of matrices to x. For example, we may want to test for associations between an outcome of interest and all measurements in x[[1]] while correcting for measurements in x[[2]].</p>
<p>By default, if all rows in x[[1]] and x[[2]] have the same row names, the function assumes that rows that share the same name should be grouped together. If the x matrices share row names but differ from y, we group the x’s by row name and test against all combinations with y. Else, we test all possible combinations of x and y:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># List of x datasets vs y - same rownames</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> <span class="kw">list</span>(xExample1, xExample2), <span class="dt">y =</span> yExample1)
<span class="co">#&gt; Warning in BuildFormula(x = x, y = y, groups = groups, by = by, xName = xName, : Warning: argument &quot;formula&quot; undefined. Using formula constructed from provided data: y ~ x1 + x2</span>
<span class="kw">dim</span>(out)
<span class="co">#&gt; [1] 200   9</span>

<span class="co"># List of x datasets vs y - y rownames differ, x rownames identical</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> <span class="kw">list</span>(xExample1, xExample2), <span class="dt">y =</span> yExample2)
<span class="co">#&gt; Warning in BuildFormula(x = x, y = y, groups = groups, by = by, xName = xName, : Warning: argument &quot;formula&quot; undefined. Using formula constructed from provided data: y ~ x1 + x2</span>
<span class="kw">dim</span>(out)
<span class="co">#&gt; [1] 2000    9</span>

<span class="co"># List of x datasets vs y - x and y rownames differ</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> <span class="kw">list</span>(xExample1, xExample3), <span class="dt">y =</span> yExample2)
<span class="co">#&gt; Warning in BuildFormula(x = x, y = y, groups = groups, by = by, xName = xName, : Warning: argument &quot;formula&quot; undefined. Using formula constructed from provided data: y ~ x1 + x2</span>
<span class="kw">dim</span>(out)
<span class="co">#&gt; [1] 20000     9</span>
<span class="kw">head</span>(out)
<span class="co">#&gt;           y           x1           x2 variable    Estimate Std. Error</span>
<span class="co">#&gt; 1: outcome1 observation1 observation1       x1 -0.16043656  0.2482816</span>
<span class="co">#&gt; 2: outcome1 observation1 observation1       x2  0.01581414  0.2219527</span>
<span class="co">#&gt; 3: outcome1 observation2 observation1       x1 -0.30980855  0.2778718</span>
<span class="co">#&gt; 4: outcome1 observation2 observation1       x2 -0.07122571  0.2281514</span>
<span class="co">#&gt; 5: outcome1 observation3 observation1       x1 -0.19461865  0.2233289</span>
<span class="co">#&gt; 6: outcome1 observation3 observation1       x2  0.01597477  0.2196934</span>
<span class="co">#&gt;        t value    pValue       fdr</span>
<span class="co">#&gt; 1: -0.64618776 0.5267856 0.9797805</span>
<span class="co">#&gt; 2:  0.07125005 0.9440303 0.9991572</span>
<span class="co">#&gt; 3: -1.11493330 0.2803932 0.9605658</span>
<span class="co">#&gt; 4: -0.31218613 0.7586957 0.9991572</span>
<span class="co">#&gt; 5: -0.87144414 0.3956522 0.9624083</span>
<span class="co">#&gt; 6:  0.07271391 0.9428825 0.9991572</span></code></pre></div>
<p>Here, the first three columns of the output report the names of the rows from each dataset that were used in the model. The variable column indicates the name of the coefficient in the model. By default, the function returns coefficients for values in x, but we can specify desired coefficients using the returnVars parameter (see <strong>Changing Return Variables</strong> below).</p>
</div>
<div id="combining-x-y-and-groups" class="section level3">
<h3>Combining x, y, and groups</h3>
<p>To test for associations between rows of x and y while adjusting for factors in groups, such as batch, we can simply add groups:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># x vs y with groups</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> <span class="kw">list</span>(xExample1, xExample2), <span class="dt">y =</span> yExample1,
                      <span class="dt">groups =</span> groupsExample1)
<span class="co">#&gt; Warning in BuildFormula(x = x, y = y, groups = groups, by = by, xName = xName, : Warning: argument &quot;formula&quot; undefined. Using formula constructed from provided data: y ~ measure + group + batch + x1 + x2</span>
<span class="kw">head</span>(out)
<span class="co">#&gt;               y           x1           x2 variable    Estimate Std. Error</span>
<span class="co">#&gt; 1: observation1 observation1 observation1       x1 -0.16644419  0.3110731</span>
<span class="co">#&gt; 2: observation1 observation1 observation1       x2  0.03161892  0.2336908</span>
<span class="co">#&gt; 3: observation2 observation2 observation2       x1 -0.02463627  0.2417130</span>
<span class="co">#&gt; 4: observation2 observation2 observation2       x2 -0.51243285  0.2655941</span>
<span class="co">#&gt; 5: observation3 observation3 observation3       x1 -0.24074395  0.3255792</span>
<span class="co">#&gt; 6: observation3 observation3 observation3       x2 -0.29823712  0.3436906</span>
<span class="co">#&gt;       t value     pValue       fdr</span>
<span class="co">#&gt; 1: -0.5350646 0.60100130 0.9568335</span>
<span class="co">#&gt; 2:  0.1353023 0.89429894 0.9614091</span>
<span class="co">#&gt; 3: -0.1019237 0.92026271 0.9614091</span>
<span class="co">#&gt; 4: -1.9293837 0.07420346 0.7939325</span>
<span class="co">#&gt; 5: -0.7394329 0.47186145 0.9414347</span>
<span class="co">#&gt; 6: -0.8677487 0.40016192 0.9414347</span></code></pre></div>
</div>
<div id="mismatching-columns" class="section level3">
<h3>Mismatching columns</h3>
<p>Columns of x and y will be dropped if their column names are not shared across all matrices in x and y and, if defined, in the first column of groups.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># x vs y with groups - mismatching columns</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> <span class="kw">list</span>(xExample1, xExample2), <span class="dt">y =</span> yExample3,
                      <span class="dt">groups =</span> groupsExample2)
<span class="co">#&gt; Warning in ModelMultiData(x = list(xExample1, xExample2), y = yExample3, : Warning: Names not identical. Columns dropped from list element 1 of x: sample1, sample20</span>
<span class="co">#&gt; Warning in ModelMultiData(x = list(xExample1, xExample2), y = yExample3, : Warning: Names not identical. Columns dropped from list element 2 of x: sample1, sample20</span>
<span class="co">#&gt; Warning in ModelMultiData(x = list(xExample1, xExample2), y = yExample3, : Warning: Names not identical. Columns dropped from y: sample1</span>
<span class="co">#&gt; Warning in BuildFormula(x = x, y = y, groups = groups, by = by, xName = xName, : Warning: argument &quot;formula&quot; undefined. Using formula constructed from provided data: y ~ measure + group + batch + x1 + x2</span></code></pre></div>
</div>
</div>
<div id="defining-comparisons" class="section level2">
<h2>Defining Comparisons</h2>
<p>The comparisons parameter allows users to pre-define which combinations of rows in x and y should be tested. Column names should match data set names provided in xName (or default xName values) and in yName if y is provided. Each row should include the respective rownames or row numbers from each dataset in x and y that should be tested together.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Supply comparisons matrix</span>
<span class="kw">head</span>(comparisonsExample)
<span class="co">#&gt;      y               x1              x2             </span>
<span class="co">#&gt; [1,] &quot;observation67&quot; &quot;observation55&quot; &quot;observation45&quot;</span>
<span class="co">#&gt; [2,] &quot;observation99&quot; &quot;observation90&quot; &quot;observation91&quot;</span>
<span class="co">#&gt; [3,] &quot;observation91&quot; &quot;observation71&quot; &quot;observation8&quot; </span>
<span class="co">#&gt; [4,] &quot;observation20&quot; &quot;observation77&quot; &quot;observation17&quot;</span>
<span class="co">#&gt; [5,] &quot;observation87&quot; &quot;observation92&quot; &quot;observation9&quot; </span>
<span class="co">#&gt; [6,] &quot;observation61&quot; &quot;observation80&quot; &quot;observation98&quot;</span>

out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> <span class="kw">list</span>(xExample1, xExample2), <span class="dt">y =</span> yExample1,
                      <span class="dt">groups =</span> groupsExample1,
                      <span class="dt">comparisons =</span> comparisonsExample)
<span class="co">#&gt; Warning in BuildFormula(x = x, y = y, groups = groups, by = by, xName = xName, : Warning: argument &quot;formula&quot; undefined. Using formula constructed from provided data: y ~ measure + group + batch + x1 + x2</span>
<span class="kw">head</span>(out)
<span class="co">#&gt;                y            x1            x2 variable    Estimate Std. Error</span>
<span class="co">#&gt; 1: observation67 observation55 observation45       x1  0.17085141  0.2386362</span>
<span class="co">#&gt; 2: observation67 observation55 observation45       x2  0.17967105  0.2602315</span>
<span class="co">#&gt; 3: observation99 observation90 observation91       x1  0.09750028  0.2924054</span>
<span class="co">#&gt; 4: observation99 observation90 observation91       x2 -0.02380972  0.1960961</span>
<span class="co">#&gt; 5: observation91 observation71  observation8       x1 -0.01808446  0.3710052</span>
<span class="co">#&gt; 6: observation91 observation71  observation8       x2 -0.22539455  0.2617607</span>
<span class="co">#&gt;        t value    pValue       fdr</span>
<span class="co">#&gt; 1:  0.71594936 0.4857938 0.9112946</span>
<span class="co">#&gt; 2:  0.69042778 0.5012121 0.9112946</span>
<span class="co">#&gt; 3:  0.33344206 0.7437420 0.9836715</span>
<span class="co">#&gt; 4: -0.12141863 0.9050850 0.9836715</span>
<span class="co">#&gt; 5: -0.04874448 0.9618115 0.9836715</span>
<span class="co">#&gt; 6: -0.86107110 0.4037056 0.9112946</span>

<span class="co"># Supply comparisons matrix for a list of x matrices with xName defined</span>
<span class="kw">head</span>(comparisonsExample2)
<span class="co">#&gt;      y               test1           test2          </span>
<span class="co">#&gt; [1,] &quot;observation67&quot; &quot;observation55&quot; &quot;observation45&quot;</span>
<span class="co">#&gt; [2,] &quot;observation99&quot; &quot;observation90&quot; &quot;observation91&quot;</span>
<span class="co">#&gt; [3,] &quot;observation91&quot; &quot;observation71&quot; &quot;observation8&quot; </span>
<span class="co">#&gt; [4,] &quot;observation20&quot; &quot;observation77&quot; &quot;observation17&quot;</span>
<span class="co">#&gt; [5,] &quot;observation87&quot; &quot;observation92&quot; &quot;observation9&quot; </span>
<span class="co">#&gt; [6,] &quot;observation61&quot; &quot;observation80&quot; &quot;observation98&quot;</span>

out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> <span class="kw">list</span>(xExample1, xExample2), <span class="dt">y =</span> yExample1,
                      <span class="dt">groups =</span> groupsExample1, <span class="dt">xName =</span> <span class="kw">c</span>(<span class="st">&quot;test1&quot;</span>, <span class="st">&quot;test2&quot;</span>),
                      <span class="dt">comparisons =</span> comparisonsExample2)
<span class="co">#&gt; Warning in BuildFormula(x = x, y = y, groups = groups, by = by, xName = xName, : Warning: argument &quot;formula&quot; undefined. Using formula constructed from provided data: y ~ measure + group + batch + test1 + test2</span>
<span class="kw">head</span>(out)
<span class="co">#&gt;                y         test1         test2 variable    Estimate Std. Error</span>
<span class="co">#&gt; 1: observation67 observation55 observation45    test1  0.17085141  0.2386362</span>
<span class="co">#&gt; 2: observation67 observation55 observation45    test2  0.17967105  0.2602315</span>
<span class="co">#&gt; 3: observation99 observation90 observation91    test1  0.09750028  0.2924054</span>
<span class="co">#&gt; 4: observation99 observation90 observation91    test2 -0.02380972  0.1960961</span>
<span class="co">#&gt; 5: observation91 observation71  observation8    test1 -0.01808446  0.3710052</span>
<span class="co">#&gt; 6: observation91 observation71  observation8    test2 -0.22539455  0.2617607</span>
<span class="co">#&gt;        t value    pValue       fdr</span>
<span class="co">#&gt; 1:  0.71594936 0.4857938 0.9112946</span>
<span class="co">#&gt; 2:  0.69042778 0.5012121 0.9112946</span>
<span class="co">#&gt; 3:  0.33344206 0.7437420 0.9836715</span>
<span class="co">#&gt; 4: -0.12141863 0.9050850 0.9836715</span>
<span class="co">#&gt; 5: -0.04874448 0.9618115 0.9836715</span>
<span class="co">#&gt; 6: -0.86107110 0.4037056 0.9112946</span>

<span class="co"># Supply comparisons matrix for named list of x matrices</span>
<span class="kw">head</span>(comparisonsExample2)
<span class="co">#&gt;      y               test1           test2          </span>
<span class="co">#&gt; [1,] &quot;observation67&quot; &quot;observation55&quot; &quot;observation45&quot;</span>
<span class="co">#&gt; [2,] &quot;observation99&quot; &quot;observation90&quot; &quot;observation91&quot;</span>
<span class="co">#&gt; [3,] &quot;observation91&quot; &quot;observation71&quot; &quot;observation8&quot; </span>
<span class="co">#&gt; [4,] &quot;observation20&quot; &quot;observation77&quot; &quot;observation17&quot;</span>
<span class="co">#&gt; [5,] &quot;observation87&quot; &quot;observation92&quot; &quot;observation9&quot; </span>
<span class="co">#&gt; [6,] &quot;observation61&quot; &quot;observation80&quot; &quot;observation98&quot;</span>

out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> <span class="kw">list</span>(<span class="dt">test1 =</span> xExample1, <span class="dt">test2 =</span> xExample2), 
                      <span class="dt">y =</span> yExample1, <span class="dt">groups =</span> groupsExample1, 
                      <span class="dt">comparisons =</span> comparisonsExample2)
<span class="co">#&gt; Warning in BuildFormula(x = x, y = y, groups = groups, by = by, xName = xName, : Warning: argument &quot;formula&quot; undefined. Using formula constructed from provided data: y ~ measure + group + batch + test1 + test2</span>
<span class="kw">head</span>(out)
<span class="co">#&gt;                y         test1         test2 variable    Estimate Std. Error</span>
<span class="co">#&gt; 1: observation67 observation55 observation45    test1  0.17085141  0.2386362</span>
<span class="co">#&gt; 2: observation67 observation55 observation45    test2  0.17967105  0.2602315</span>
<span class="co">#&gt; 3: observation99 observation90 observation91    test1  0.09750028  0.2924054</span>
<span class="co">#&gt; 4: observation99 observation90 observation91    test2 -0.02380972  0.1960961</span>
<span class="co">#&gt; 5: observation91 observation71  observation8    test1 -0.01808446  0.3710052</span>
<span class="co">#&gt; 6: observation91 observation71  observation8    test2 -0.22539455  0.2617607</span>
<span class="co">#&gt;        t value    pValue       fdr</span>
<span class="co">#&gt; 1:  0.71594936 0.4857938 0.9112946</span>
<span class="co">#&gt; 2:  0.69042778 0.5012121 0.9112946</span>
<span class="co">#&gt; 3:  0.33344206 0.7437420 0.9836715</span>
<span class="co">#&gt; 4: -0.12141863 0.9050850 0.9836715</span>
<span class="co">#&gt; 5: -0.04874448 0.9618115 0.9836715</span>
<span class="co">#&gt; 6: -0.86107110 0.4037056 0.9112946</span>

<span class="co"># Supply comparisons matrix with row numbers rather than names </span>
<span class="kw">head</span>(comparisonsExample3)
<span class="co">#&gt;       y x1  x2</span>
<span class="co">#&gt; [1,] 59 93  39</span>
<span class="co">#&gt; [2,] 85 40   6</span>
<span class="co">#&gt; [3,] 94 70 100</span>
<span class="co">#&gt; [4,] 37  2  43</span>
<span class="co">#&gt; [5,] 60 74  60</span>
<span class="co">#&gt; [6,] 33  7  44</span>

out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> <span class="kw">list</span>(xExample1, xExample2), <span class="dt">y =</span> yExample1,
                      <span class="dt">groups =</span> groupsExample1, 
                      <span class="dt">comparisons =</span> comparisonsExample3)
<span class="co">#&gt; Warning in BuildFormula(x = x, y = y, groups = groups, by = by, xName = xName, : Warning: argument &quot;formula&quot; undefined. Using formula constructed from provided data: y ~ measure + group + batch + x1 + x2</span>
<span class="kw">head</span>(out)
<span class="co">#&gt;     y x1  x2 variable    Estimate Std. Error    t value     pValue       fdr</span>
<span class="co">#&gt; 1: 59 93  39       x1 -0.30537319  0.2776358 -1.0999056 0.28992722 0.7576667</span>
<span class="co">#&gt; 2: 59 93  39       x2 -0.54892616  0.2231041 -2.4604040 0.02748783 0.2748783</span>
<span class="co">#&gt; 3: 85 40   6       x1 -0.03436251  0.3078264 -0.1116295 0.91270184 0.9865168</span>
<span class="co">#&gt; 4: 85 40   6       x2  0.38155987  0.3686447  1.0350343 0.31820146 0.7576667</span>
<span class="co">#&gt; 5: 94 70 100       x1 -0.22938954  0.2045679 -1.1213370 0.28101037 0.7576667</span>
<span class="co">#&gt; 6: 94 70 100       x2  0.36078568  0.2300538  1.5682662 0.13913839 0.6956920</span></code></pre></div>
</div>
<div id="adjusting-the-model" class="section level2">
<h2>Adjusting the Model</h2>
<p>If no formula is provided, a formula will be built from provided data, but this formula can be adjusted using yName, xName, includeVars, and excludeVars. The left-hand (dependent) variable will be set to yName.</p>
<p>yName default values are:</p>
<ul>
<li>“y” if y is defined</li>
<li>else the left-hand variable will be defined as the second column of groups after applying includeVars and excludeVar</li>
</ul>
<p>If yName is defined, the left-hand variable will be defined as the column of groups that matches yName.</p>
<p>xName provides the names of the matrices supplied to x. Defining xName can be helpful for interpreting output or when providing your own formula.</p>
<p>includeVars should be a character vector including column names in groups that should be included in the formula, and excludeVars is a character vector including column names in groups that should be excluded from formula.</p>
<p>The right-hand of formula will include all in xName and all remaining columns in groups after applying includeVars and excludeVars.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># x vs groups - change yName</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> xExample1, <span class="dt">groups =</span> groupsExample1, <span class="dt">yName =</span> <span class="st">&quot;batch&quot;</span>)
<span class="co">#&gt; Warning in BuildFormula(x = x, y = y, groups = groups, by = by, xName = xName, : Warning: argument &quot;formula&quot; undefined. Using formula constructed from provided data: batch ~ measure + group + x1</span>

<span class="co"># x vs groups - exclude variables</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> xExample1, <span class="dt">groups =</span> groupsExample1, <span class="dt">yName =</span> <span class="st">&quot;batch&quot;</span>,
                      <span class="dt">excludeVars =</span> <span class="st">&quot;measure&quot;</span>)
<span class="co">#&gt; Warning in BuildFormula(x = x, y = y, groups = groups, by = by, xName = xName, : Warning: argument &quot;formula&quot; undefined. Using formula constructed from provided data: batch ~ group + x1</span>

<span class="co"># x vs groups - include variables</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> xExample1, <span class="dt">groups =</span> groupsExample1, <span class="dt">yName =</span> <span class="st">&quot;batch&quot;</span>,
                      <span class="dt">includeVars =</span> <span class="st">&quot;group&quot;</span>)
<span class="co">#&gt; Warning in BuildFormula(x = x, y = y, groups = groups, by = by, xName = xName, : Warning: argument &quot;formula&quot; undefined. Using formula constructed from provided data: batch ~ group + x1</span></code></pre></div>
<p>Alternatively, the user may provide a formula. Of note, this formula should include all values in yName and xName.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># supply formula - x vs groups</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> xExample1, <span class="dt">groups =</span> groupsExample1,
                      <span class="dt">formula =</span> measure <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>batch,
                      <span class="dt">xName =</span> <span class="st">&quot;x&quot;</span>)

<span class="co"># supply formula - list of x vs y - x names not provided</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> <span class="kw">list</span>(xExample1, xExample2), <span class="dt">y =</span> yExample1,
                      <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2)

<span class="co"># supply formula - list of x vs y - xNames provided</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> <span class="kw">list</span>(<span class="dt">test1 =</span> xExample1, <span class="dt">test2 =</span> xExample2), 
                      <span class="dt">y =</span> yExample1,
                      <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>test1 <span class="op">+</span><span class="st"> </span>test2)

out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> <span class="kw">list</span>(xExample1, xExample2), 
                      <span class="dt">y =</span> yExample1,
                      <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>test1 <span class="op">+</span><span class="st"> </span>test2, 
                      <span class="dt">xName =</span> <span class="kw">c</span>(<span class="st">&quot;test1&quot;</span>, <span class="st">&quot;test2&quot;</span>))

<span class="co"># supply formula - list of x vs y - yName changed to match formula</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> <span class="kw">list</span>(xExample1, xExample2), 
                      <span class="dt">y =</span> yExample1, <span class="dt">yName =</span> <span class="st">&quot;outcome&quot;</span>, 
                      <span class="dt">formula =</span> outcome <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2)

<span class="co"># supply formula - x vs y with groups</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> <span class="kw">list</span>(xExample1, xExample2), <span class="dt">y =</span> yExample1,
                      <span class="dt">groups =</span> groupsExample1,
                      <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>batch)</code></pre></div>
</div>
<div id="changing-model-function" class="section level2">
<h2>Changing model function</h2>
<p>By default, the ModelMultiData function applies a linear model. However, we can apply any function in the regression model function family by defining FUN. Additional parameters for these functions can be added to function call and will be passed to function in FUN.</p>
<p>For example, if we want to run a logistic regression we can define FUN as glm() and add the parameter family = binomial().</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># x vs groups - change yName</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> xExample1, <span class="dt">groups =</span> groupsExample1, 
                      <span class="dt">formula =</span> group <span class="op">~</span><span class="st"> </span>x1,
                      <span class="dt">FUN =</span> glm, <span class="dt">family =</span> <span class="kw">binomial</span>())
<span class="kw">head</span>(out)
<span class="co">#&gt;              x1 variable    Estimate Std. Error    z value    pValue       fdr</span>
<span class="co">#&gt; 1: observation1       x1  0.09013184  0.4902282  0.1838569 0.8541257 0.9468369</span>
<span class="co">#&gt; 2: observation2       x1  0.43493737  0.5580829  0.7793418 0.4357784 0.9101735</span>
<span class="co">#&gt; 3: observation3       x1  0.63575161  0.5369336  1.1840414 0.2363967 0.9101735</span>
<span class="co">#&gt; 4: observation4       x1  0.34590647  0.4603111  0.7514624 0.4523744 0.9101735</span>
<span class="co">#&gt; 5: observation5       x1 -0.24699285  0.4762837 -0.5185835 0.6040512 0.9468369</span>
<span class="co">#&gt; 6: observation6       x1 -0.43616876  0.4685237 -0.9309428 0.3518832 0.9101735</span></code></pre></div>
</div>
<div id="changing-return-variables" class="section level2">
<h2>Changing Return Variables</h2>
<p>By default, ModelMultiData returns all coefficients for variables in xName. To return different or additional variables, we can supply a character vector of coefficient variable names to returnVars. To return all coefficients (including intercept), use “*“.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Change return variable to batch</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> xListUnnamedExample, <span class="dt">y =</span> yExample1,
                      <span class="dt">groups =</span> groupsExample1,
                      <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>batch,
                      <span class="dt">returnVars =</span> <span class="st">&quot;batch&quot;</span>)
<span class="kw">head</span>(out)
<span class="co">#&gt;               y           x1           x2 variable    Estimate Std. Error</span>
<span class="co">#&gt; 1: observation1 observation1 observation1    batch  0.06157682  0.2123834</span>
<span class="co">#&gt; 2: observation2 observation2 observation2    batch -0.62317208  0.2151592</span>
<span class="co">#&gt; 3: observation3 observation3 observation3    batch  0.24895598  0.2739706</span>
<span class="co">#&gt; 4: observation4 observation4 observation4    batch  0.19609796  0.1730999</span>
<span class="co">#&gt; 5: observation5 observation5 observation5    batch  0.01073237  0.1880787</span>
<span class="co">#&gt; 6: observation6 observation6 observation6    batch  0.18342921  0.2238429</span>
<span class="co">#&gt;        t value     pValue       fdr</span>
<span class="co">#&gt; 1:  0.28993230 0.77559177 0.8813543</span>
<span class="co">#&gt; 2: -2.89633040 0.01052082 0.5363989</span>
<span class="co">#&gt; 3:  0.90869590 0.37699532 0.8636043</span>
<span class="co">#&gt; 4:  1.13285988 0.27396453 0.8238219</span>
<span class="co">#&gt; 5:  0.05706317 0.95520143 0.9648499</span>
<span class="co">#&gt; 6:  0.81945528 0.42456566 0.8636043</span>

<span class="co"># Change return variable to include all</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> xListUnnamedExample, <span class="dt">y =</span> yExample1,
                      <span class="dt">groups =</span> groupsExample1,
                      <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>batch,
                      <span class="dt">returnVars =</span> <span class="st">&quot;*&quot;</span>)
<span class="kw">head</span>(out)
<span class="co">#&gt;               y           x1           x2    variable     Estimate Std. Error</span>
<span class="co">#&gt; 1: observation1 observation1 observation1 (Intercept)  0.017419319  0.5415821</span>
<span class="co">#&gt; 2: observation1 observation1 observation1          x1 -0.190832734  0.2717435</span>
<span class="co">#&gt; 3: observation1 observation1 observation1          x2  0.004597503  0.2168939</span>
<span class="co">#&gt; 4: observation1 observation1 observation1       batch  0.061576819  0.2123834</span>
<span class="co">#&gt; 5: observation2 observation2 observation2 (Intercept)  1.637232949  0.5510171</span>
<span class="co">#&gt; 6: observation2 observation2 observation2          x1  0.004050035  0.2483656</span>
<span class="co">#&gt;        t value     pValue       fdr</span>
<span class="co">#&gt; 1:  0.03216376 0.97473927 0.9971629</span>
<span class="co">#&gt; 2: -0.70225304 0.49261207 0.9127925</span>
<span class="co">#&gt; 3:  0.02119702 0.98335059 0.9971629</span>
<span class="co">#&gt; 4:  0.28993230 0.77559177 0.9401112</span>
<span class="co">#&gt; 5:  2.97129243 0.00900244 0.7151986</span>
<span class="co">#&gt; 6:  0.01630675 0.98719129 0.9971629</span></code></pre></div>
</div>
<div id="stratified-analysis-using-by" class="section level2">
<h2>Stratified Analysis Using “by”</h2>
<p>We can use the “by” parameter to conduct a stratified analysis, splitting data by one or more variables in groups. We supply a character vector specifying the names of the column or columns in groups that will be used to split data if stratified analysis desired.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># x vs y with groups and one by parameter</span>
out &lt;-<span class="st"> </span><span class="kw">ModelMultiData</span>(<span class="dt">x =</span> xListUnnamedExample, <span class="dt">y =</span> yExample1,
                      <span class="dt">groups =</span> groupsExample1,
                      <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>measure,
                      <span class="dt">by =</span> <span class="st">&quot;group&quot;</span>)</code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
